"use strict";(()=>{var e={};e.id=31,e.ids=[31],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},2781:e=>{e.exports=require("stream")},3837:e=>{e.exports=require("util")},4261:(e,t,s)=>{s.r(t),s.d(t,{originalPathname:()=>h,patchFetch:()=>v,requestAsyncStorage:()=>f,routeModule:()=>N,serverHooks:()=>y,staticGenerationAsyncStorage:()=>g});var r={};s.r(r),s.d(r,{DELETE:()=>x,PUT:()=>m,dynamic:()=>l,revalidate:()=>c});var a=s(9303),n=s(8716),o=s(670),i=s(7070),u=s(3493),d=s(9178),p=s(7334);let l="force-dynamic",c=0;async function m(e,{params:t}){let s=(0,d.W)(e.headers.get("authorization"));if(!s)return i.NextResponse.json({message:"N\xe3o autorizado"},{status:401});let r=Number(t.id);if(Number.isNaN(r))return i.NextResponse.json({message:"ID inv\xe1lido"},{status:400});let{description:a,amount:n,category:o,date:l,payCycleId:c}=await e.json(),m={};if(void 0!==a&&(m.description=a),void 0!==o&&(m.category=o||null),void 0!==n){let e=parseFloat(n);if(Number.isNaN(e))return i.NextResponse.json({message:"Valor inv\xe1lido"},{status:400});m.amount=e}if(void 0!==l){let e=new Date(l);if(Number.isNaN(e.getTime()))return i.NextResponse.json({message:"Data inv\xe1lida"},{status:400});m.date=e}if(void 0!==c){if(null===c||""===c)m.payCycleId=null;else{let e=Number(c);if(Number.isNaN(e))return i.NextResponse.json({message:"Ciclo de pagamento inv\xe1lido"},{status:400});let t=await u._.payCycle.findUnique({where:{id:e}});if(!t||t.userId!==s)return i.NextResponse.json({message:"Ciclo de pagamento n\xe3o encontrado"},{status:404});m.payCycleId=e}}try{let e=await u._.expense.findUnique({where:{id:r}});if(!e||e.userId!==s)return i.NextResponse.json({message:"Despesa n\xe3o encontrada"},{status:404});let t=await u._.expense.update({where:{id:r},data:m});return i.NextResponse.json((0,p.l)(t))}catch(e){return console.error("Erro ao atualizar despesa",e),i.NextResponse.json({message:"Erro interno ao atualizar"},{status:500})}}async function x(e,{params:t}){let s=(0,d.W)(e.headers.get("authorization"));if(!s)return i.NextResponse.json({message:"N\xe3o autorizado"},{status:401});let r=Number(t.id);if(Number.isNaN(r))return i.NextResponse.json({message:"ID inv\xe1lido"},{status:400});try{let e=await u._.expense.findUnique({where:{id:r}});if(!e||e.userId!==s)return i.NextResponse.json({message:"Despesa n\xe3o encontrada"},{status:404});return await u._.expense.delete({where:{id:r}}),i.NextResponse.json({},{status:204})}catch(e){return console.error("Erro ao excluir despesa",e),i.NextResponse.json({message:"Erro interno ao excluir despesa"},{status:500})}}let N=new a.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/expenses/[id]/route",pathname:"/api/expenses/[id]",filename:"route",bundlePath:"app/api/expenses/[id]/route"},resolvedPagePath:"C:\\Users\\User\\Desktop\\controle-gastos\\backend\\app\\api\\expenses\\[id]\\route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:f,staticGenerationAsyncStorage:g,serverHooks:y}=N,h="/api/expenses/[id]/route";function v(){return(0,o.patchFetch)({serverHooks:y,staticGenerationAsyncStorage:g})}},9178:(e,t,s)=>{s.d(t,{R:()=>o,W:()=>i});var r=s(1482),a=s.n(r);let n=process.env.JWT_SECRET||"change-me";function o(e){return a().sign({userId:e},n,{expiresIn:"7d"})}function i(e){if(!e||!e.startsWith("Bearer "))return null;let t=e.split(" ")[1];try{return a().verify(t,n).userId}catch(e){return null}}},7334:(e,t,s)=>{s.d(t,{l:()=>r});function r(e){let t=e.amount&&"function"==typeof e.amount.toNumber?e.amount.toNumber():Number(e.amount);return{id:e.id,description:e.description,amount:t,category:e.category,date:e.date,userId:e.userId,payCycleId:e.payCycleId??null,createdAt:e.createdAt,updatedAt:e.updatedAt}}},3493:(e,t,s)=>{s.d(t,{_:()=>a});let r=require("@prisma/client"),a=globalThis.prisma||new r.PrismaClient({log:["error","warn"]})}};var t=require("../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[948,547],()=>s(4261));module.exports=r})();